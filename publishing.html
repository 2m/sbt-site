<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Publishing · sbt-site</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='sbt-site'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="css/page.css"/>

<!--
<link rel="shortcut icon" href="images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>sbt-site
</a>
<div class="version-number">
1.2.1
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="getting-started.html">Getting Started</a></li>
  <li><a href="preprocess.html">Preprocessing</a></li>
  <li><a href="api-documentation.html">API documentation</a></li>
  <li><a href="generators/index.html">Site Generators</a>
  <ul>
    <li><a href="generators/asciidoctor.html">Asciidoctor</a></li>
    <li><a href="generators/gitbook.html">GitBook</a></li>
    <li><a href="generators/hugo.html">Hugo</a></li>
    <li><a href="generators/jekyll.html">Jekyll</a></li>
    <li><a href="generators/laika.html">Laika</a></li>
    <li><a href="generators/nanoc.html">Nanoc</a></li>
    <li><a href="generators/pamflet.html">Pamflet</a></li>
    <li><a href="generators/paradox.html">Paradox</a></li>
    <li><a href="generators/sphinx.html">Sphinx</a></li>
  </ul></li>
  <li><a href="publishing.html" class="active">Publishing</a></li>
  <li><a href="advanced-usage.html">Advanced Usage</a></li>
  <li><a href="migration-guide.html">Migration Guide</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="index.html">sbt-site</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>sbt-site
</a>
<div class="version-number">
1.2.1
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="getting-started.html">Getting Started</a></li>
  <li><a href="preprocess.html">Preprocessing</a></li>
  <li><a href="api-documentation.html">API documentation</a></li>
  <li><a href="generators/index.html">Site Generators</a>
  <ul>
    <li><a href="generators/asciidoctor.html">Asciidoctor</a></li>
    <li><a href="generators/gitbook.html">GitBook</a></li>
    <li><a href="generators/hugo.html">Hugo</a></li>
    <li><a href="generators/jekyll.html">Jekyll</a></li>
    <li><a href="generators/laika.html">Laika</a></li>
    <li><a href="generators/nanoc.html">Nanoc</a></li>
    <li><a href="generators/pamflet.html">Pamflet</a></li>
    <li><a href="generators/paradox.html">Paradox</a></li>
    <li><a href="generators/sphinx.html">Sphinx</a></li>
  </ul></li>
  <li><a href="publishing.html" class="active">Publishing</a></li>
  <li><a href="advanced-usage.html">Advanced Usage</a></li>
  <li><a href="migration-guide.html">Migration Guide</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="index.html">sbt-site</a></li>
  <li>Publishing</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#publishing" name="publishing" class="anchor"><span class="anchor-link"></span></a>Publishing</h1>
<p>The following sections show you how to configure publishing of your site. To publish a generated site to <a href="https://pages.github.com">GitHub Pages</a> you can use the <a href="http://github.com/sbt/sbt-ghpages">sbt-ghpages</a> plugin. For sites hosted on S3 one option is to use <a href="https://github.com/sbt/sbt-s3">sbt-s3</a>. We expect other publishing mechanisms to be supported in the future.</p>
<h2><a href="#publishing-to-github-pages-using-sbt-ghpages" name="publishing-to-github-pages-using-sbt-ghpages" class="anchor"><span class="anchor-link"></span></a>Publishing to GitHub Pages using sbt-ghpages</h2>
<p>Set up the plugin by adding the following to <code>project/plugins.sbt</code> (check the <a href="http://github.com/sbt/sbt-ghpages">sbt-ghpages project</a> for the most recent version).</p>
<pre class="prettyprint"><code class="language-sbt">addSbtPlugin(&quot;com.typesafe.sbt&quot; % &quot;sbt-ghpages&quot; % &quot;0.5.4&quot;)</code></pre>
<p>Then configure your sbt build to use a special remote when running on Travis CI and otherwise fall back to the normal Git remote configured via the <code>scmInfo</code> setting.</p>
<pre class="prettyprint"><code class="language-sbt">scmInfo := Some(ScmInfo(url(&quot;https://github.com/sbt/sbt-site&quot;), &quot;git@github.com:sbt/sbt-site.git&quot;))
ghpages.settings
git.remoteRepo := scmInfo.value.get.connection</code></pre>
<p>At this point you should be able to run <code>sbt ghpagesPushSite</code> to publish your site.</p><div class="callout note "><div class="callout-title">Note</div>
<p>Before running <code>sbt ghpagesPushSite</code> the first time you need to create the <code>gh-pages</code> branch. One way to do it is to build your site and publish a first version of it using the following commands:</p>
<pre class="prettyprint"><code class="language-sh">$ sbt clean make-site                             # &lt;1&gt; Build the site
$ origin=$(git remote get-url origin)             # &lt;2&gt; Save the current remote for later
$ cd target/site
$ git init                                        # &lt;3&gt; Create site repo and add initial content
$ git add .
$ git commit -m &quot;Initial import of GitHub Pages&quot;
$ git push --force &quot;$origin&quot; master:gh-pages      # &lt;4&gt; Publish the repo&#39;s master branch as gh-pages
</code></pre></div>
<h2><a href="#publishing-to-github-pages-from-travis-ci" name="publishing-to-github-pages-from-travis-ci" class="anchor"><span class="anchor-link"></span></a>Publishing to GitHub Pages from Travis CI</h2>
<p>The following section walks you through the steps to configure Travis CI to publish your site as part of the <a href="https://docs.travis-ci.com/user/deployment">deployment process</a>. It assumes that you have already configured your sbt project to publish your site using the sbt-ghpages plugin as described in the previous section.</p><div class="callout warning "><div class="callout-title">Security Considerations</div>
<p>The authentication mechanism that enables Travis CI to update the <code>gh-pages</code> branch requires that write access to your GitHub project is granted to an SSH key pair that you control. An encrypted version of the secret key must be added to the Git repository in order for Travis CI to decrypt it and make it available for pushing to your Git repository. This means that anyone with the ability to modify the Travis CI or sbt build configuration will be able to get hold of the secret key and gain write access to your GitHub repository. For this reason it is recommented to disable publishing for pull requests.</p>
<p>The instructions are based on <a href="https://gist.github.com/domenic/ec8b0fc8ab45f39403dd">this gist</a> and you are encouraged to consult the reasons for choosing this authentication mechanism.</p></div>
<p>To authenticate Travis CI to publish changes to the <code>gh-pages</code> branch you need to first generate an SSH key pair:</p>
<pre class="prettyprint"><code class="language-sh">$ ssh-keygen -t rsa -b 4096 -C &quot;sbt-site@travis&quot; -f project/travis-deploy-key
</code></pre>
<p>Add the public key found in <code>project/travis-deploy-key.pub</code> as a deploy key in the <strong>Deploy Keys</strong> section of your GitHub project&rsquo;s settings page at <a href="https://github.com/[org]/[repo]/settings/keys">https://github.com/[org]/[repo]/settings/keys</a>. Make sure you allow write access for the deploy key by clicking the check box.</p>
<p><img src="img/add-travis-deploy-key.png" alt="Add the Travis SSH Deploy Key" /></p>
<p>Prepare the secret key for inclusion in the repository by opening a terminal and encrypting the secret key file using the Travis CLI:</p>
<pre class="prettyprint"><code class="nocode">$ gem install travis
$ travis encrypt-file project/travis-deploy-key project/travis-deploy-key.enc
encrypting project/travis-deploy-key for [org]/[repo]
storing result as project/travis-deploy-key.enc
storing secure env variables for decryption

Please add the following to your build script (before_install stage in your .travis.yml, for instance):

    openssl aes-256-cbc -K $encrypted_3afbfedfa397_key -iv $encrypted_3afbfedfa397_iv -in project/travis-deploy-key.enc -out project/travis-deploy-key -d

Pro Tip: You can add it automatically by running with --add.

Make sure to add project/travis-deploy-key.enc to the git repository.
Make sure not to add project/travis-deploy-key to the git repository.
Commit all changes to your .travis.yml.
</code></pre>
<p>As instructed in the output of the command add the encrypted secret key found in <code>project/travis-deploy-key.enc</code> to the repository and delete or ignore the unencrypted secret key file.</p>
<pre><code>$ git add project/travis-deploy-key.enc
$ echo project/travis-deploy-key &gt;&gt; .git/info/exclude
</code></pre>
<p>Finally, configure a deploy step in <code>.travis.yml</code> using the script provider. For a complete set of options and triggers see the <a href="https://docs.travis-ci.com/user/deployment">Travis deployment documentation</a>. In this example, we publishing when a tag is created and explicitly disable publishing for pull request. The <code>before_deploy</code> step takes care of setting up the environment so that <code>git push</code> automatically finds the deploy key.</p>
<pre class="prettyprint"><code class="language-yml">before_deploy:
  # Record minimal build information via the Git user ident
  - git config --global user.name &quot;$USER&quot;
  - git config --global user.email &quot;$TRAVIS_BUILD_NUMBER@$TRAVIS_COMMIT&quot;
  # Decrypt the secret deploy key using instructions from `travis encrypt-file`
  - openssl aes-256-cbc -K $encrypted_3afbfedfa397_key -iv $encrypted_3afbfedfa397_iv -in project/travis-deploy-key.enc -out project/travis-deploy-key -d
  - chmod 600 project/travis-deploy-key
  # Start ssh-agent in the background and load the deploy key
  - eval &quot;$(ssh-agent -s)&quot;
  - ssh-add project/travis-deploy-key

deploy:
  provider: script
  script: sbt ghpagesPushSite
  skip_cleanup: true
  on:
    tags: true
    condition: $TRAVIS_PULL_REQUEST = false</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p>Ensure that you modify the above example to use the instructions on how to decrypt the deploy key provided in the output of the <code>travis encrypt-file</code> command.</p>
<p>At this point, it would also be a good idea to run <code>travis lint</code> to check that the resulting <code>.travis.yml</code> is correct.</p></div>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/sbt/sbt-site/tree/master/src/main/paradox/publishing.md">here</a>.
</div>

<div class="nav-next">
<p><strong>Next:</strong> <a href="advanced-usage.html">Advanced Usage</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="publishing.html#publishing">Publishing</a>
  <ul>
    <li><a href="publishing.html#publishing-to-github-pages-using-sbt-ghpages">Publishing to GitHub Pages using sbt-ghpages</a></li>
    <li><a href="publishing.html#publishing-to-github-pages-from-travis-ci">Publishing to GitHub Pages from Travis CI</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2017</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/magellan.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>

</html>
